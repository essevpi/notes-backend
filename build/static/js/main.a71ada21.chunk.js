(this.webpackJsonppart2b=this.webpackJsonppart2b||[]).push([[0],{42:function(e,t,n){},43:function(e,t,n){"use strict";n.r(t);var r=n(17),a=n.n(r),c=n(3),o=n.n(c),s=n(5),u=n(8),i=n(4),l=n(1),j=n(0),d=function(e){var t=e.note,n=e.toggleImportance,r=t.important?"make not important":"make important";return Object(j.jsxs)("div",{children:[Object(j.jsx)("li",{className:"note",children:t.content}),Object(j.jsx)("button",{onClick:n,children:r})]})},b=function(e){var t=e.message;return null===t?null:Object(j.jsx)("div",{className:"error",children:t})},p=function(){return Object(j.jsxs)("div",{style:{color:"#AAAAFF",fontStyle:"italic",fontSize:12,textAlign:"center"},children:[Object(j.jsx)("br",{}),Object(j.jsx)("em",{children:"Note app - Fullstack Open 2021"})]})},f=n(6),O=n.n(f),h="/api/notes",m=null,v={getAll:function(){return O.a.get(h).then((function(e){return e.data}))},create:function(){var e=Object(s.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:m}},e.next=3,O.a.post(h,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(e,t){return O.a.put("".concat(h,"/").concat(e),t).then((function(e){return e.data}))},setToken:function(e){m="bearer ".concat(e)}},x={logIn:function(){var e=Object(s.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},g=function(e){var t=e.addNote,n=e.handleNoteChange,r=e.newNote;return Object(j.jsxs)("form",{className:"NoteForm",onSubmit:t,children:[Object(j.jsx)("input",{onChange:n,value:r}),Object(j.jsx)("button",{type:"submit",children:"Save"})]})},w=function(e){var t=e.username,n=e.password,r=e.setUsername,a=e.setPassword,c=e.handleLogin;return Object(j.jsxs)("form",{onSubmit:c,children:[Object(j.jsxs)("div",{children:[Object(j.jsx)("label",{children:"Username: "}),Object(j.jsx)("input",{type:"text",value:t,name:"Username",onChange:function(e){var t=e.target;return r(t.value)}})]}),Object(j.jsxs)("div",{children:[Object(j.jsx)("label",{children:"Password: "}),Object(j.jsx)("input",{type:"password",value:n,name:"Password",onChange:function(e){var t=e.target;return a(t.value)}})]}),Object(j.jsx)("button",{type:"submit",children:"Login"})]})},S=function(){var e=Object(l.useState)([]),t=Object(i.a)(e,2),n=t[0],r=t[1],a=Object(l.useState)(""),c=Object(i.a)(a,2),f=c[0],O=c[1],h=Object(l.useState)(!0),m=Object(i.a)(h,2),S=m[0],N=m[1],k=Object(l.useState)(null),y=Object(i.a)(k,2),A=y[0],I=y[1],C=Object(l.useState)(""),U=Object(i.a)(C,2),T=U[0],F=U[1],J=Object(l.useState)(""),P=Object(i.a)(J,2),D=P[0],E=P[1],L=Object(l.useState)(null),z=Object(i.a)(L,2),B=z[0],M=z[1];Object(l.useEffect)((function(){v.getAll().then((function(e){r(e)}))}),[]),Object(l.useEffect)((function(){var e=window.localStorage.getItem("loggedNoteAppUser");if(e){var t=JSON.parse(e);M(t),v.setToken(t.token)}}),[]);var W=S?n:n.filter((function(e){return e.important})),q=function(){var e=Object(s.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,x.logIn({username:T,password:D});case 4:n=e.sent,window.localStorage.setItem("loggedNoteAppUser",JSON.stringify(n)),v.setToken(n.token),M(n),F(""),E(""),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),I("Wrong credentials"),setTimeout((function(){I(null)}),5e3);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(j.jsxs)("div",{className:"App",children:[Object(j.jsx)("h1",{children:"Notes"}),Object(j.jsx)(b,{message:A}),null===B?Object(j.jsx)(w,{username:T,password:D,setUsername:F,setPassword:E,handleLogin:q}):Object(j.jsxs)("div",{children:[Object(j.jsxs)("p",{children:[B.name," is logged"]}),Object(j.jsx)(g,{addNote:function(e){e.preventDefault();var t={content:f,date:(new Date).toISOString(),important:Math.random()<.5};v.create(t).then((function(e){r(n.concat(e)),O("")}))},handleNoteChange:function(e){O(e.target.value)},newNote:f})]}),Object(j.jsxs)("div",{children:[Object(j.jsx)("ul",{children:W.map((function(e){return Object(j.jsx)(d,{note:e,toggleImportance:function(){return function(e){var t=n.find((function(t){return t.id===e})),a=Object(u.a)(Object(u.a)({},t),{},{important:!t.important});v.update(e,a).then((function(t){r(n.map((function(n){return n.id!==e?n:t})))})).catch((function(a){I('Note "'.concat(t.content,'" was already removed from server')),setTimeout((function(){I(null)}),5e3),r(n.filter((function(t){return t.id!==e})))}))}(e.id)}},e.id)}))}),Object(j.jsx)("button",{onClick:function(){N(!S)},children:S?"Show important":"Show all"})]}),Object(j.jsx)(p,{})]})};n(42);a.a.render(Object(j.jsx)(S,{}),document.getElementById("root"))}},[[43,1,2]]]);
//# sourceMappingURL=main.a71ada21.chunk.js.map